#!/usr/bin/env sh
# bd-shim v1
# bd-hooks-version: 0.49.4
#
# bd (beads) prepare-commit-msg hook - thin shim
#
# This shim delegates to 'bd hook prepare-commit-msg' which contains
# the actual hook logic. This pattern ensures hook behavior is always
# in sync with the installed bd version - no manual updates needed.
#
# Arguments:
#   $1 = path to the commit message file
#   $2 = source of commit message (message, template, merge, squash, commit)
#   $3 = commit SHA-1 (if -c, -C, or --amend)

# Check if bd is available
if ! command -v bd >/dev/null 2>&1; then
    echo "Warning: bd command not found in PATH, skipping prepare-commit-msg hook" >&2
    echo "  Install bd: brew install beads" >&2
    echo "  Or add bd to your PATH" >&2
    exit 0
fi

# Try new API first, fall back to old API
bd hook prepare-commit-msg "$@" 2>/dev/null || bd hooks run prepare-commit-msg "$@" 2>/dev/null || true
